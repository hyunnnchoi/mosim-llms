-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          ProfilerStep*         0.00%       0.000us         0.00%       0.000us       0.000us     230.256ms        39.57%     230.256ms     230.256ms           0 b           0 b           0 b           0 b             1            --  
                                               aten::mm         0.77%       2.122ms         1.11%       3.061ms      30.914us     129.474ms        22.25%     129.474ms       1.308ms           0 b           0 b       1.35 Gb       1.35 Gb            99   1170069.258  
                        DistributedDataParallel.forward         0.00%       0.000us         0.00%       0.000us       0.000us      75.180ms        12.92%      75.180ms      75.180ms           0 b           0 b           0 b           0 b             1            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8...         0.00%       0.000us         0.00%       0.000us       0.000us      43.075ms         7.40%      43.075ms       1.723ms           0 b           0 b           0 b           0 b            25            --  
                                 ampere_sgemm_128x64_tn         0.00%       0.000us         0.00%       0.000us       0.000us      41.578ms         7.14%      41.578ms       1.124ms           0 b           0 b           0 b           0 b            37            --  
                                            aten::addmm         0.62%       1.699ms         0.82%       2.264ms      47.163us      37.159ms         6.39%      37.159ms     774.151us           0 b           0 b     648.50 Mb     648.50 Mb            48    347892.351  
                        ampere_sgemm_64x32_sliced1x4_nn         0.00%       0.000us         0.00%       0.000us       0.000us      30.394ms         5.22%      30.394ms       2.338ms           0 b           0 b           0 b           0 b            13            --  
                                     record_param_comms         0.85%       2.332ms         0.96%       2.633ms     114.493us      14.624ms         2.51%      14.624ms     635.821us           0 b           0 b           0 b           0 b            23            --  
ncclDevKernel_AllReduce_Sum_f32_RING_LL(ncclDevComm*...         0.00%       0.000us         0.00%       0.000us       0.000us      14.570ms         2.50%      14.570ms       1.041ms           0 b           0 b           0 b           0 b            14            --  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us      14.570ms         2.50%      14.570ms       1.041ms           0 b           0 b           0 b           0 b            14            --  
                                 ampere_sgemm_32x128_tn         0.00%       0.000us         0.00%       0.000us       0.000us      13.300ms         2.29%      13.300ms       1.108ms           0 b           0 b           0 b           0 b            12            --  
                              Optimizer.step#AdamW.step         0.00%       0.000us         0.00%       0.000us       0.000us      12.821ms         2.20%      12.821ms      12.821ms           0 b           0 b           0 b           0 b             1            --  
                                              aten::mul         0.90%       2.488ms         1.59%       4.375ms      14.879us      12.292ms         2.11%      12.292ms      41.809us           0 b           0 b       3.17 Gb       3.17 Gb           294       974.442  
                                 ampere_sgemm_128x64_nn         0.00%       0.000us         0.00%       0.000us       0.000us      11.902ms         2.05%      11.902ms     991.831us           0 b           0 b           0 b           0 b            12            --  
                    aten::_efficient_attention_backward         0.15%     412.044us         0.59%       1.611ms     134.274us      11.216ms         1.93%      11.916ms     993.034us           0 b           0 b     220.50 Mb    -147.31 Mb            12            --  
fmha_cutlassB_f32_aligned_64x64_k64_dropout_sm80(PyT...         0.00%       0.000us         0.00%       0.000us       0.000us      11.216ms         1.93%      11.216ms     934.670us           0 b           0 b           0 b           0 b            12            --  
                        ampere_sgemm_32x32_sliced1x4_nt         0.00%       0.000us         0.00%       0.000us       0.000us       9.908ms         1.70%       9.908ms     825.651us           0 b           0 b           0 b           0 b            12            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us       9.139ms         1.57%       9.139ms     761.552us           0 b           0 b           0 b           0 b            12            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.126ms         1.22%       7.126ms      30.582us           0 b           0 b           0 b           0 b           233            --  
                     aten::_efficient_attention_forward         0.08%     230.082us         0.22%     595.146us      49.596us       5.753ms         0.99%       5.753ms     479.433us         192 b           0 b      73.12 Mb           0 b            12            --  
fmha_cutlassF_f32_aligned_64x64_rf_sm80(PyTorchMemEf...         0.00%       0.000us         0.00%       0.000us       0.000us       5.753ms         0.99%       5.753ms     479.433us           0 b           0 b           0 b           0 b            12            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.277ms         0.91%       5.277ms      62.082us           0 b           0 b           0 b           0 b            85            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.156ms         0.89%       5.156ms      85.929us           0 b           0 b           0 b           0 b            60            --  
                                    aten::_foreach_mul_         0.09%     256.616us         0.13%     370.160us      92.540us       3.920ms         0.67%       3.920ms     980.023us           0 b           0 b           0 b           0 b             4            --  
                        ampere_sgemm_64x32_sliced1x4_nt         0.00%       0.000us         0.00%       0.000us       0.000us       3.746ms         0.64%       3.746ms     312.146us           0 b           0 b           0 b           0 b            12            --  
                        ampere_sgemm_32x32_sliced1x4_nn         0.00%       0.000us         0.00%       0.000us       0.000us       3.519ms         0.60%       3.519ms     293.239us           0 b           0 b           0 b           0 b            12            --  
                                             aten::add_         0.15%     404.474us         0.22%     614.490us       3.103us       3.151ms         0.54%       3.151ms      15.914us           0 b           0 b           0 b           0 b           198            --  
                                            aten::copy_         0.29%     788.730us         0.68%       1.863ms       8.431us       3.126ms         0.54%       3.126ms      14.147us           0 b           0 b           0 b           0 b           221            --  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       3.055ms         0.53%       3.055ms      17.459us           0 b           0 b           0 b           0 b           175            --  
                                              aten::add         0.22%     608.889us         0.31%     860.158us      16.866us       2.914ms         0.50%       2.914ms      57.140us           0 b           0 b     873.74 Mb     873.74 Mb            51       228.914  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       2.613ms         0.45%       2.613ms     200.998us           0 b           0 b           0 b           0 b            13            --  
                                aten::_foreach_addcdiv_         0.06%     169.054us         0.08%     214.991us     107.496us       2.450ms         0.42%       2.450ms       1.225ms           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       2.450ms         0.42%       2.450ms     306.262us           0 b           0 b           0 b           0 b             8            --  
                       aten::_log_softmax_backward_data         0.01%      16.925us         0.06%     165.914us     165.914us       2.090ms         0.36%       2.090ms       2.090ms           0 b           0 b     392.63 Mb     392.63 Mb             1            --  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us       2.090ms         0.36%       2.090ms       2.090ms           0 b           0 b           0 b           0 b             1            --  
                                     aten::_log_softmax         0.01%      25.310us         0.06%     168.302us     168.302us       2.009ms         0.35%       2.009ms       2.009ms           0 b           0 b     392.63 Mb     392.63 Mb             1            --  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us       2.009ms         0.35%       2.009ms       2.009ms           0 b           0 b           0 b           0 b             1            --  
                                aten::_foreach_addcmul_         0.06%     158.712us         0.07%     205.175us     102.588us       1.892ms         0.33%       1.892ms     946.039us           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.892ms         0.33%       1.892ms     236.510us           0 b           0 b           0 b           0 b             8            --  
                                   aten::_foreach_lerp_         0.02%      54.555us         0.04%      98.570us      49.285us       1.876ms         0.32%       1.876ms     937.752us           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.876ms         0.32%       1.876ms     234.438us           0 b           0 b           0 b           0 b             8            --  
                                              aten::pow         0.13%     358.434us         0.26%     719.815us      29.992us       1.687ms         0.29%       1.687ms      70.284us           0 b           0 b     576.00 Mb     576.00 Mb            24            --  
                                              aten::sum         0.37%       1.019ms         0.56%       1.535ms      25.162us       1.577ms         0.27%       1.577ms      25.847us           0 b           0 b       2.94 Mb       2.94 Mb            61            --  
                                    aten::tanh_backward         0.04%     106.591us         0.06%     168.575us      14.048us       1.315ms         0.23%       1.315ms     109.590us           0 b           0 b     288.00 Mb     288.00 Mb            12            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.315ms         0.23%       1.315ms     109.590us           0 b           0 b           0 b           0 b            12            --  
                                    aten::_foreach_div_         0.05%     131.929us         0.06%     173.908us      86.954us       1.313ms         0.23%       1.313ms     656.628us           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.313ms         0.23%       1.313ms     187.608us           0 b           0 b           0 b           0 b             7            --  
                                    aten::_foreach_add_         0.12%     335.223us         0.18%     483.883us     120.971us       1.312ms         0.23%       1.312ms     327.946us           0 b           0 b           0 b           0 b             4            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.312ms         0.23%       1.312ms     187.398us           0 b           0 b           0 b           0 b             7            --  
                                              aten::cat         0.24%     660.633us         0.39%       1.078ms      27.635us       1.311ms         0.23%       1.311ms      33.622us           0 b           0 b     363.50 Mb     363.50 Mb            39            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 275.172ms
Self CUDA time total: 581.950ms
