-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          ProfilerStep*         0.00%       0.000us         0.00%       0.000us       0.000us     248.619ms        35.84%     248.619ms     248.619ms           0 b           0 b           0 b           0 b             1            --  
                                               aten::mm         0.72%       2.106ms         1.03%       3.030ms      30.607us     131.725ms        18.99%     131.725ms       1.331ms           0 b           0 b       1.35 Gb       1.35 Gb            99   1170069.258  
                        DistributedDataParallel.forward         0.00%       0.000us         0.00%       0.000us       0.000us      75.480ms        10.88%      75.480ms      75.480ms           0 b           0 b           0 b           0 b             1            --  
                                     record_param_comms         0.78%       2.272ms         0.88%       2.579ms     112.131us      60.051ms         8.66%      60.051ms       2.611ms           0 b           0 b           0 b           0 b            23            --  
ncclDevKernel_AllReduce_Sum_f32_RING_LL(ncclDevComm*...         0.00%       0.000us         0.00%       0.000us       0.000us      59.961ms         8.64%      59.961ms       4.283ms           0 b           0 b           0 b           0 b            14            --  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us      59.961ms         8.64%      59.961ms       4.283ms           0 b           0 b           0 b           0 b            14            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8...         0.00%       0.000us         0.00%       0.000us       0.000us      43.401ms         6.26%      43.401ms       1.736ms           0 b           0 b           0 b           0 b            25            --  
                                 ampere_sgemm_128x64_tn         0.00%       0.000us         0.00%       0.000us       0.000us      42.069ms         6.06%      42.069ms       1.137ms           0 b           0 b           0 b           0 b            37            --  
                                            aten::addmm         0.56%       1.643ms         0.75%       2.202ms      45.879us      37.306ms         5.38%      37.306ms     777.202us           0 b           0 b     648.50 Mb     648.50 Mb            48    347892.351  
                        ampere_sgemm_64x32_sliced1x4_nn         0.00%       0.000us         0.00%       0.000us       0.000us      30.525ms         4.40%      30.525ms       2.348ms           0 b           0 b           0 b           0 b            13            --  
                                 ampere_sgemm_32x128_tn         0.00%       0.000us         0.00%       0.000us       0.000us      14.448ms         2.08%      14.448ms       1.204ms           0 b           0 b           0 b           0 b            12            --  
                              Optimizer.step#AdamW.step         0.00%       0.000us         0.00%       0.000us       0.000us      12.819ms         1.85%      12.819ms      12.819ms           0 b           0 b           0 b           0 b             1            --  
                                              aten::mul         0.83%       2.419ms         1.48%       4.331ms      14.733us      12.009ms         1.73%      12.009ms      40.846us           0 b           0 b       3.17 Gb       3.17 Gb           294       974.442  
                                 ampere_sgemm_128x64_nn         0.00%       0.000us         0.00%       0.000us       0.000us      11.951ms         1.72%      11.951ms     995.922us           0 b           0 b           0 b           0 b            12            --  
                    aten::_efficient_attention_backward         0.14%     399.193us         0.54%       1.589ms     132.436us      11.333ms         1.63%      12.031ms       1.003ms           0 b           0 b     220.50 Mb    -147.31 Mb            12            --  
fmha_cutlassB_f32_aligned_64x64_k64_dropout_sm80(PyT...         0.00%       0.000us         0.00%       0.000us       0.000us      11.333ms         1.63%      11.333ms     944.388us           0 b           0 b           0 b           0 b            12            --  
                        ampere_sgemm_32x32_sliced1x4_nt         0.00%       0.000us         0.00%       0.000us       0.000us      10.008ms         1.44%      10.008ms     834.014us           0 b           0 b           0 b           0 b            12            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us       9.171ms         1.32%       9.171ms     764.235us           0 b           0 b           0 b           0 b            12            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       7.012ms         1.01%       7.012ms      30.095us           0 b           0 b           0 b           0 b           233            --  
                     aten::_efficient_attention_forward         0.08%     222.978us         0.20%     574.790us      47.899us       5.767ms         0.83%       5.767ms     480.553us         192 b           0 b      73.12 Mb           0 b            12            --  
fmha_cutlassF_f32_aligned_64x64_rf_sm80(PyTorchMemEf...         0.00%       0.000us         0.00%       0.000us       0.000us       5.767ms         0.83%       5.767ms     480.553us           0 b           0 b           0 b           0 b            12            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       5.173ms         0.75%       5.173ms      60.860us           0 b           0 b           0 b           0 b            85            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       4.986ms         0.72%       4.986ms      83.101us           0 b           0 b           0 b           0 b            60            --  
                                    aten::_foreach_mul_         0.09%     249.881us         0.12%     362.335us      90.584us       3.924ms         0.57%       3.924ms     980.975us           0 b           0 b           0 b           0 b             4            --  
                        ampere_sgemm_64x32_sliced1x4_nt         0.00%       0.000us         0.00%       0.000us       0.000us       3.791ms         0.55%       3.791ms     315.882us           0 b           0 b           0 b           0 b            12            --  
                        ampere_sgemm_32x32_sliced1x4_nn         0.00%       0.000us         0.00%       0.000us       0.000us       3.532ms         0.51%       3.532ms     294.309us           0 b           0 b           0 b           0 b            12            --  
                                             aten::add_         0.14%     400.058us         0.21%     611.132us       3.087us       3.047ms         0.44%       3.047ms      15.389us           0 b           0 b           0 b           0 b           198            --  
                                              aten::add         0.21%     606.267us         0.29%     853.513us      16.736us       2.912ms         0.42%       2.912ms      57.104us           0 b           0 b     873.74 Mb     873.74 Mb            51       228.914  
                                            aten::copy_         0.27%     790.309us         0.64%       1.890ms       8.551us       2.906ms         0.42%       2.906ms      13.147us           0 b           0 b           0 b           0 b           221            --  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       2.834ms         0.41%       2.834ms      16.195us           0 b           0 b           0 b           0 b           175            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       2.612ms         0.38%       2.612ms     200.932us           0 b           0 b           0 b           0 b            13            --  
                                aten::_foreach_addcdiv_         0.06%     168.844us         0.07%     213.510us     106.755us       2.445ms         0.35%       2.445ms       1.223ms           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       2.445ms         0.35%       2.445ms     305.682us           0 b           0 b           0 b           0 b             8            --  
                       aten::_log_softmax_backward_data         0.01%      16.988us         0.06%     164.795us     164.795us       2.097ms         0.30%       2.097ms       2.097ms           0 b           0 b     392.63 Mb     392.63 Mb             1            --  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us       2.097ms         0.30%       2.097ms       2.097ms           0 b           0 b           0 b           0 b             1            --  
                                     aten::_log_softmax         0.01%      23.162us         0.06%     183.183us     183.183us       1.997ms         0.29%       1.997ms       1.997ms           0 b           0 b     392.63 Mb     392.63 Mb             1            --  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us       1.997ms         0.29%       1.997ms       1.997ms           0 b           0 b           0 b           0 b             1            --  
                                aten::_foreach_addcmul_         0.05%     154.391us         0.07%     198.699us      99.350us       1.889ms         0.27%       1.889ms     944.278us           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.889ms         0.27%       1.889ms     236.070us           0 b           0 b           0 b           0 b             8            --  
                                   aten::_foreach_lerp_         0.02%      49.362us         0.03%      92.731us      46.365us       1.882ms         0.27%       1.882ms     941.190us           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.882ms         0.27%       1.882ms     235.298us           0 b           0 b           0 b           0 b             8            --  
                                              aten::sum         0.35%       1.012ms         0.52%       1.523ms      24.969us       1.861ms         0.27%       1.861ms      30.502us           0 b           0 b       2.94 Mb       2.94 Mb            61            --  
                                              aten::pow         0.12%     362.397us         0.24%     705.652us      29.402us       1.553ms         0.22%       1.553ms      64.690us           0 b           0 b     576.00 Mb     576.00 Mb            24            --  
                       aten::native_layer_norm_backward         0.11%     319.578us         0.30%     890.687us      35.627us       1.519ms         0.22%       1.519ms      60.767us           0 b           0 b     154.65 Mb           0 b            25            --  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       1.492ms         0.22%       1.492ms      30.444us           0 b           0 b           0 b           0 b            49            --  
                                              aten::cat         0.21%     622.869us         0.36%       1.045ms      26.785us       1.317ms         0.19%       1.317ms      33.762us           0 b           0 b     363.50 Mb     363.50 Mb            39            --  
                                    aten::_foreach_div_         0.05%     140.428us         0.06%     182.170us      91.085us       1.312ms         0.19%       1.312ms     655.957us           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.312ms         0.19%       1.312ms     187.416us           0 b           0 b           0 b           0 b             7            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.312ms         0.19%       1.312ms     187.398us           0 b           0 b           0 b           0 b             7            --  
                                    aten::_foreach_add_         0.11%     327.631us         0.16%     478.647us     119.662us       1.307ms         0.19%       1.307ms     326.874us           0 b           0 b           0 b           0 b             4            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 293.080ms
Self CUDA time total: 693.759ms
