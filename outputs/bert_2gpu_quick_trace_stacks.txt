-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          ProfilerStep*         0.00%       0.000us         0.00%       0.000us       0.000us     196.567ms        40.05%     196.567ms     196.567ms           0 b           0 b           0 b           0 b             1            --  
                                               aten::mm         1.22%       2.997ms         1.63%       3.993ms      26.982us     101.602ms        20.70%     101.602ms     686.499us           0 b           0 b       1.06 Gb       1.06 Gb           148    892644.360  
                        DistributedDataParallel.forward         0.00%       0.000us         0.00%       0.000us       0.000us      66.148ms        13.48%      66.148ms      66.148ms           0 b           0 b           0 b           0 b             1            --  
                                            aten::addmm         1.05%       2.570ms         1.92%       4.705ms      63.575us      53.356ms        10.87%      53.356ms     721.031us           0 b           0 b     892.45 Mb     892.45 Mb            74    446322.180  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8...         0.00%       0.000us         0.00%       0.000us       0.000us      35.906ms         7.31%      35.906ms       1.436ms           0 b           0 b           0 b           0 b            25            --  
                        ampere_sgemm_32x32_sliced1x4_tn         0.00%       0.000us         0.00%       0.000us       0.000us      31.402ms         6.40%      31.402ms     514.795us           0 b           0 b           0 b           0 b            61            --  
                                 ampere_sgemm_128x64_tn         0.00%       0.000us         0.00%       0.000us       0.000us      21.954ms         4.47%      21.954ms       1.689ms           0 b           0 b           0 b           0 b            13            --  
                        ampere_sgemm_64x32_sliced1x4_nt         0.00%       0.000us         0.00%       0.000us       0.000us      15.009ms         3.06%      15.009ms     306.310us           0 b           0 b           0 b           0 b            49            --  
                        ampere_sgemm_32x32_sliced1x4_nn         0.00%       0.000us         0.00%       0.000us       0.000us      13.770ms         2.81%      13.770ms       1.147ms           0 b           0 b           0 b           0 b            12            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us      13.153ms         2.68%      13.153ms     268.438us           0 b           0 b           0 b           0 b            49            --  
                                  ampere_sgemm_64x64_nn         0.00%       0.000us         0.00%       0.000us       0.000us      13.113ms         2.67%      13.113ms       1.093ms           0 b           0 b           0 b           0 b            12            --  
                              Optimizer.step#AdamW.step         0.00%       0.000us         0.00%       0.000us       0.000us      11.492ms         2.34%      11.492ms      11.492ms           0 b           0 b           0 b           0 b             1            --  
                    aten::_efficient_attention_backward         0.16%     402.000us         0.69%       1.692ms     140.985us      11.004ms         2.24%      11.692ms     974.343us           0 b           0 b     223.98 Mb    -148.31 Mb            12            --  
fmha_cutlassB_f32_aligned_64x64_k64_dropout_sm80(PyT...         0.00%       0.000us         0.00%       0.000us       0.000us      11.004ms         2.24%      11.004ms     917.038us           0 b           0 b           0 b           0 b            12            --  
                                 ampere_sgemm_32x128_nn         0.00%       0.000us         0.00%       0.000us       0.000us      10.648ms         2.17%      10.648ms      10.648ms           0 b           0 b           0 b           0 b             1            --  
                                     record_param_comms         0.95%       2.337ms         1.10%       2.693ms     122.401us       8.088ms         1.65%       8.088ms     367.643us           0 b           0 b           0 b           0 b            22            --  
ncclDevKernel_AllReduce_Sum_f32_RING_LL(ncclDevComm*...         0.00%       0.000us         0.00%       0.000us       0.000us       8.068ms         1.64%       8.068ms     537.845us           0 b           0 b           0 b           0 b            15            --  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us       8.068ms         1.64%       8.068ms     537.845us           0 b           0 b           0 b           0 b            15            --  
                     aten::_efficient_attention_forward         0.10%     249.717us         0.32%     776.898us      64.741us       5.784ms         1.18%       5.784ms     481.966us         192 b           0 b      73.12 Mb           0 b            12            --  
fmha_cutlassF_f32_aligned_64x64_rf_sm80(PyTorchMemEf...         0.00%       0.000us         0.00%       0.000us       0.000us       5.784ms         1.18%       5.784ms     481.966us           0 b           0 b           0 b           0 b            12            --  
                                    aten::_foreach_mul_         0.14%     354.328us         0.19%     475.792us     118.948us       3.487ms         0.71%       3.487ms     871.703us           0 b           0 b           0 b           0 b             4            --  
                                            aten::copy_         0.35%     845.887us         0.90%       2.207ms       9.682us       2.491ms         0.51%       2.491ms      10.926us           0 b           0 b           0 b           0 b           228            --  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us       2.400ms         0.49%       2.400ms      11.705us           0 b           0 b           0 b           0 b           205            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       2.324ms         0.47%       2.324ms     166.013us           0 b           0 b           0 b           0 b            14            --  
                                aten::_foreach_addcdiv_         0.09%     225.159us         0.11%     278.576us     139.288us       2.209ms         0.45%       2.209ms       1.105ms           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       2.209ms         0.45%       2.209ms     245.484us           0 b           0 b           0 b           0 b             9            --  
                                              aten::sum         0.60%       1.463ms         0.98%       2.410ms      27.707us       2.097ms         0.43%       2.097ms      24.101us           0 b           0 b       3.06 Mb       3.06 Mb            87            --  
                                   aten::_foreach_lerp_         0.02%      57.035us         0.04%      99.596us      49.798us       1.683ms         0.34%       1.683ms     841.495us           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.683ms         0.34%       1.683ms     210.374us           0 b           0 b           0 b           0 b             8            --  
                                aten::_foreach_addcmul_         0.08%     204.139us         0.11%     258.958us     129.479us       1.682ms         0.34%       1.682ms     841.046us           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.682ms         0.34%       1.682ms     186.899us           0 b           0 b           0 b           0 b             9            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.675ms         0.34%       1.675ms      22.635us           0 b           0 b           0 b           0 b            74            --  
                                              aten::mul         0.61%       1.492ms         1.14%       2.782ms      12.940us       1.468ms         0.30%       1.468ms       6.829us           0 b           0 b      73.00 Mb      73.00 Mb           215       128.389  
                       aten::native_layer_norm_backward         0.15%     366.181us         0.42%       1.031ms      39.651us       1.446ms         0.29%       1.446ms      55.616us           0 b           0 b     159.47 Mb           0 b            26            --  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       1.438ms         0.29%       1.438ms      19.432us           0 b           0 b           0 b           0 b            74            --  
                       aten::_log_softmax_backward_data         0.01%      23.552us         0.11%     263.665us     263.665us       1.232ms         0.25%       1.232ms       1.232ms           0 b           0 b     238.45 Mb     238.45 Mb             1            --  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us       1.232ms         0.25%       1.232ms       1.232ms           0 b           0 b           0 b           0 b             1            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.221ms         0.25%       1.221ms       6.137us           0 b           0 b           0 b           0 b           199            --  
                                    aten::_foreach_div_         0.07%     177.651us         0.09%     229.584us     114.792us       1.181ms         0.24%       1.181ms     590.308us           0 b           0 b           0 b           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.181ms         0.24%       1.181ms     147.577us           0 b           0 b           0 b           0 b             8            --  
                                    aten::_foreach_add_         0.21%     505.542us         0.28%     697.801us     174.450us       1.178ms         0.24%       1.178ms     294.554us           0 b           0 b           0 b           0 b             4            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.178ms         0.24%       1.178ms     147.277us           0 b           0 b           0 b           0 b             8            --  
                                    aten::_foreach_sqrt         0.15%     371.541us         0.49%       1.196ms     597.823us       1.167ms         0.24%       1.167ms     583.300us           0 b           0 b     417.76 Mb           0 b             2            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.167ms         0.24%       1.167ms     145.825us           0 b           0 b           0 b           0 b             8            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us       1.163ms         0.24%       1.163ms     193.772us           0 b           0 b           0 b           0 b             6            --  
                                    aten::gelu_backward         0.06%     139.635us         0.09%     216.375us      16.644us       1.156ms         0.24%       1.156ms      88.921us           0 b           0 b     294.00 Mb     294.00 Mb            13            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.156ms         0.24%       1.156ms      88.921us           0 b           0 b           0 b           0 b            13            --  
                                             aten::add_         0.19%     476.270us         0.31%     762.727us       3.039us     944.261us         0.19%     944.261us       3.762us           0 b           0 b           0 b           0 b           251            --  
                                     aten::_log_softmax         0.01%      27.404us         0.06%     150.608us     150.608us     834.566us         0.17%     834.566us     834.566us           0 b           0 b     238.45 Mb     238.45 Mb             1            --  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us     834.566us         0.17%     834.566us     834.566us           0 b           0 b           0 b           0 b             1            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 245.058ms
Self CUDA time total: 490.862ms
